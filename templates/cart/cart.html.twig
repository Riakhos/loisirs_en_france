{% extends 'base.html.twig' %}

{% block title %}Mon panier!{% endblock %}

{% block body %}
    {# Barre de navigation #}
    <ul class="nav nav-tabs bg-primaryBlue shadow-sm p-3 rounded">
        <li class="nav-item">
            <a class="nav-link" href="{{ path('app_account') }}">Tableau de bord</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{ path('app_account_reservation') }}">Réservations</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{ path('app_account_profil') }}">Mon profil</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{ path('app_account_message') }}">Messages</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{ path('app_account_notice') }}">Avis</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="{{ path('app_cart') }}">Mon panier</a>
        </li>
    </ul>
    {# Contenu principal #}
    <div class="container w-auto d-flex justify-content-center align-items-center my-5">
        {# <div class="toast d-flex justify-content-center align-items-center"> #}
            {# Liste des activités #}
            {# <div class="col-md-8">
                {% for activity in cart %}
                    <div class="row mt-2">
                        <div class="col-md-2 m-2">
                            <img src="/uploads/{{ activity.object.image }}" class="img-fluid" alt="{{ activity.object.name }}">
                        </div>
                        <div class="col-md-6">
                            <strong>{{ activity.object.name }}</strong>
                            <span class="d-block small">Prix unitaire : {{ activity.object.priceWt|price }}</span>
                        </div>
                        <div class="col-md-2 text-right">
                            <span class="badge bg-background">x{{ activity.qty }}</span>
                        </div>
                        <div class="col-md-2">
                            <strong class="color-tertiary-custom p-2">{{ (activity.qty * activity.object.priceWt)|price }}</strong>
                        </div>
                    </div>
                {% endfor %}
            </div> #}
            {# <div class="col-md-4">
                Récap de mon panier (prix, bouton commander)
            </div> #}
        <div class="row">
            <div class="col-md-8">
                {% for activity in cart %}
                    <div class="card mb-4 shadow-sm border-1">
                        <div class="row g-0">
                            <div class="col-md-4">
                                <img 
                                    src="/uploads/{{ activity.object.image }}" 
                                    class="img-fluid rounded-start h-100 object-fit-cover" 
                                    alt="{{ activity.object.name }}">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <h5 class="card-title">{{ activity.object.name }}</h5>
                                    <p class="card-text">
                                        <span>Prix unitaire :</span> 
                                        <strong>{{ activity.object.priceWt|price }}</strong>
                                    </p>
                                    <p class="card-text">
                                        <span>Quantité :</span> 
                                        <span class="badge bg-primaryBlue color-secondary-custom">x{{ activity.qty }}</span>
                                    </p>
                                    <p class="card-text">
                                        <strong>Total :</strong> 
                                        <span class="text-success">{{ (activity.qty * activity.object.priceWt)|price }}</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <p class="text-center text-muted">Votre panier est vide.</p>
                {% endfor %}
            </div>

            <!-- Récapitulatif du panier -->
            <div class="col-md-4">
                <div class="card shadow-sm border-1 p-3 sticky-top">
                    <h4 class="text-center">Récapitulatif</h4>
                    <hr>
                    <p class="d-flex justify-content-between">
                        <span>Sous-total HT :</span> 
                        <strong>{{ subtotal|price }}</strong>
                    </p>
                    {# Détails des TVA #}
                    {% for rate, amount in tvaDetails %}
                        <p class="d-flex justify-content-between">
                            <span>TVA ({{ rate }}%) :</span> 
                            <strong>{{ amount|price }}</strong>
                        </p>
                    {% endfor %}
                    {# Total des TVA #}
                    <p class="d-flex justify-content-between">
                        <span>Total TVA :</span> 
                        <strong>{{ tva|price }}</strong>
                    </p>
                    <hr>
                    <p class="d-flex justify-content-between">
                        <span>Total :</span> 
                        <strong class="text-success">{{ total|price }}</strong>
                    </p>
                    <a href="#" class="btn btn-primary btn-block mt-3">
                        Commander
                    </a>
                </div>
            </div>
        </div>        
    </div>
{% endblock %}
